{% extends "base.html" %}
{% block content %}
<h1 class="text-xl font-semibold mb-4">{{ 'Service bearbeiten' if item else 'Service anlegen' }}</h1>

<form method="post" class="bg-white border rounded p-4 max-w-2xl space-y-4">
  <div>
    <label class="block text-sm mb-1">Name *</label>
    <input name="name" value="{{ (form.name if form else (item.name if item else '')) }}" class="w-full border rounded px-3 py-2">
    {% if errors.name %}<div class="text-xs text-red-600 mt-1">{{ errors.name }}</div>{% endif %}
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div>
      <label class="block text-sm mb-1">Dauer (Minuten) *</label>
      <input name="dauer_min" type="number" min="1" step="1" value="{{ (form.dauer_min if form else (item.dauer_min if item else '60')) }}" class="w-full border rounded px-3 py-2">
      {% if errors.dauer_min %}<div class="text-xs text-red-600 mt-1">{{ errors.dauer_min }}</div>{% endif %}
    </div>
    <div>
      <label class="block text-sm mb-1">Basispreis (CHF) *</label>
      <input name="basispreis" type="text" value="{{ (form.basispreis if form else (item.basispreis if item else '0.00')) }}" class="w-full border rounded px-3 py-2">
      {% if errors.basispreis %}<div class="text-xs text-red-600 mt-1">{{ errors.basispreis }}</div>{% endif %}
    </div>
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div>
      <label class="block text-sm mb-1">Kategorie *</label>
      {% set k = (form.kategorie if form else (item.kategorie if item else 'Service')) %}
      <select name="kategorie" class="w-full border rounded px-3 py-2">
        <option value="Service" {% if k=='Service' %}selected{% endif %}>Service</option>
        <option value="Produkt" {% if k=='Produkt' %}selected{% endif %}>Produkt</option>
      </select>
    </div>
    <div>
      <label class="block text-sm mb-1">Steuer-Code *</label>
      {% set sc = (form.steuer_code if form else (item.steuer_code if item else 'CH-7.7')) %}
      <select name="steuer_code" class="w-full border rounded px-3 py-2">
        {% for code in tax_codes %}<option value="{{ code }}" {% if code==sc %}selected{% endif %}>{{ code }}</option>{% endfor %}
        {% if sc not in tax_codes %}<option value="{{ sc }}" selected>{{ sc }}</option>{% endif %}
      </select>
      {% if errors.steuer_code %}<div class="text-xs text-red-600 mt-1">{{ errors.steuer_code }}</div>{% endif %}
    </div>
  </div>

  <div>
    <label class="block text-sm mb-1">Materialkosten (CHF)</label>
    <input name="materialkosten" type="text" value="{{ (form.materialkosten if form else (item.materialkosten if item and item.materialkosten is not none else '0.00')) }}" class="w-full border rounded px-3 py-2">
    {% if errors.materialkosten %}<div class="text-xs text-red-600 mt-1">{{ errors.materialkosten }}</div>{% endif %}
  </div>

  <div class="flex gap-2">
    <button class="px-4 py-2 rounded bg-black text-white hover:bg-gray-800">Speichern</button>
    <a href="/katalog" class="px-4 py-2 rounded border bg-white hover:bg-gray-50">Abbrechen</a>
  </div>
</form>
{% endblock %}
