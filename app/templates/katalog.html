{% extends "base.html" %}
{% block content %}
<h1 class="text-xl font-semibold mb-4">Katalog</h1>

<form method="get" action="/katalog" class="mb-4 flex gap-2">
  <input type="text" name="q" value="{{ q or '' }}" placeholder="Suche nach Name"
         class="border rounded px-3 py-1 w-64">
  <button class="px-3 py-1 rounded border bg-white hover:bg-gray-50">Suchen</button>
  <a href="/katalog" class="px-3 py-1 rounded border bg-white hover:bg-gray-50">Zurücksetzen</a>
  <div class="ml-auto flex gap-2">
    <a href="/katalog/service/neu" class="px-3 py-1 rounded bg-black text-white hover:bg-gray-800">+ Service</a>
    <a href="/katalog/produkt/neu" class="px-3 py-1 rounded bg-black text-white hover:bg-gray-800">+ Produkt</a>
  </div>
</form>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <div class="bg-white border rounded">
    <div class="px-4 py-3 border-b font-semibold">Services</div>
    <div class="divide-y">
      {% for s in services %}
      <div class="px-4 py-3 flex items-center gap-3">
        <div class="flex-1">
          <div class="font-medium">{{ s.name }}</div>
          <div class="text-xs text-gray-500">Dauer: {{ s.dauer_min }} min • Preis: CHF {{ '%.2f'|format(s.basispreis) }} • Steuer: {{ s.steuer_code }}</div>
          {% if s.kategorie %}<div class="text-xs text-gray-400">Kategorie: {{ s.kategorie }}</div>{% endif %}
        </div>
        <span class="text-xs px-2 py-0.5 rounded {{ 'bg-emerald-100 text-emerald-800' if s.aktiv else 'bg-gray-100 text-gray-600' }}">{{ 'aktiv' if s.aktiv else 'inaktiv' }}</span>
        <a href="/katalog/service/{{ s.id }}/bearbeiten" class="text-sm px-2 py-1 rounded border bg-white hover:bg-gray-50">Bearbeiten</a>
        <form method="post" action="/katalog/service/{{ s.id }}/toggle">
          <button class="text-sm px-2 py-1 rounded border bg-white hover:bg-gray-50">{{ 'Deaktivieren' if s.aktiv else 'Aktivieren' }}</button>
        </form>
      </div>
      {% else %}
      <div class="px-4 py-6 text-sm text-gray-500">Keine Services gefunden.</div>
      {% endfor %}
    </div>
  </div>

  <div class="bg-white border rounded">
    <div class="px-4 py-3 border-b font-semibold">Produkte</div>
    <div class="divide-y">
      {% for p in produkte %}
      <div class="px-4 py-3 flex items-center gap-3">
        <div class="flex-1">
          <div class="font-medium">{{ p.name }}</div>
          <div class="text-xs text-gray-500">
            VK: CHF {{ '%.2f'|format(p.verkaufspreis) }}
            {% if p.einkaufspreis is not none %} • EK: CHF {{ '%.2f'|format(p.einkaufspreis) }}{% endif %}
            • Lager: {{ p.lagerbestand or 0 }} • Steuer: {{ p.steuer_code }}
          </div>
        </div>
        <span class="text-xs px-2 py-0.5 rounded {{ 'bg-emerald-100 text-emerald-800' if p.aktiv else 'bg-gray-100 text-gray-600' }}">{{ 'aktiv' if p.aktiv else 'inaktiv' }}</span>
        <a href="/katalog/produkt/{{ p.id }}/bearbeiten" class="text-sm px-2 py-1 rounded border bg-white hover:bg-gray-50">Bearbeiten</a>
        <form method="post" action="/katalog/produkt/{{ p.id }}/toggle">
          <button class="text-sm px-2 py-1 rounded border bg-white hover:bg-gray-50">{{ 'Deaktivieren' if p.aktiv else 'Aktivieren' }}</button>
        </form>
      </div>
      {% else %}
      <div class="px-4 py-6 text-sm text-gray-500">Keine Produkte gefunden.</div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
